--An overview of the data we will be working with
SELECT *
FROM Chemicals_in_cosmetics

--Find out which chemicals were used the most in cosmetics and personal care products

SELECT ChemicalName, COUNT(ChemicalName) AS CountOfChemical
FROM Chemicals_in_cosmetics
WHERE PrimaryCategory = 'Personal Care Products' OR PrimaryCategory = 'Makeup Products (non-permanent)'
GROUP BY ChemicalName
ORDER BY CountOfChemical DESC;
-- Titanium Dioxide was mostly used in cosmetics and personal care


--Which brands had chemicals discontinued and removed?

SELECT BrandName
FROM Chemicals_in_cosmetics
WHERE DiscontinuedDate IS NOT NULL
AND ChemicalDateRemoved IS NOT NULL
GROUP BY BrandName
-- A total of 102 brands where discontinued and removed


--Which brands had chemicals that were removed and discontinued? Identify the chemicals.
SELECT BrandName, ChemicalName
FROM Chemicals_in_cosmetics
WHERE DiscontinuedDate IS NOT NULL
AND ChemicalDateRemoved IS NOT NULL
ORDER BY ChemicalName

--Identify the brands that had chemicals which were mostly reported in 2018
SELECT BrandName, ChemicalName, InitialDateReported, MostRecentDateReported
FROM Chemicals_in_cosmetics
WHERE InitialDateReported LIKE '%2018'
AND MostRecentDateReported LIKE '%2018'

--Find out which companies used the most reported chemicals in their cosmetics and personal care products.
SELECT CompanyName
FROM Chemicals_in_cosmetics
WHERE MostRecentDateReported IN (
SELECT MostRecentDateReported
FROM Chemicals_in_cosmetics
WHERE PrimaryCategory = 'Personal Care Products' OR PrimaryCategory = 'Makeup Products (non-permanent)'
);